
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../AWS/getting-started-AWS/">
      
      
        <link rel="next" href="../blueprint/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.28">
    
    
      
        <title>Getting Started - ParaTools Pro for E4S™ Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="grey" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#paratools-pro-for-e4stm-getting-started-with-google-cloud-platform-gcp" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="ParaTools Pro for E4S™ Documentation" class="md-header__button md-logo" aria-label="ParaTools Pro for E4S™ Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ParaTools Pro for E4S™ Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Getting Started
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="grey" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="white" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../AWS/getting-started-AWS/" class="md-tabs__link">
          
  
  AWS

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  GCP

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../ODDC/getting-started-ODDC/" class="md-tabs__link">
          
  
  ODDC

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="ParaTools Pro for E4S™ Documentation" class="md-nav__button md-logo" aria-label="ParaTools Pro for E4S™ Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    ParaTools Pro for E4S™ Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    AWS
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            AWS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AWS/getting-started-AWS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    GCP
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            GCP
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#general-background-information" class="md-nav__link">
    <span class="md-ellipsis">
      General Background Information
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tutorial" class="md-nav__link">
    <span class="md-ellipsis">
      Tutorial
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tutorial">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#getting-set-up" class="md-nav__link">
    <span class="md-ellipsis">
      Getting Set Up
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-the-google-cloud-hpc-toolkit" class="md-nav__link">
    <span class="md-ellipsis">
      Install the Google Cloud HPC-Toolkit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grant-adc-access-to-terraform-and-enable-os-login" class="md-nav__link">
    <span class="md-ellipsis">
      Grant ADC access to Terraform and Enable OS Login
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-the-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      Deploy the Cluster
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connect-to-the-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      Connect to the Cluster
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deletion-of-the-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      Deletion of the Cluster
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../blueprint/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HPC Toolkit Blueprint
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cluster-Deletion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cluster Deletion
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ODDC
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            ODDC
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ODDC/getting-started-ODDC/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="paratools-pro-for-e4stm-getting-started-with-google-cloud-platform-gcp">ParaTools Pro for E4S™ Getting Started with Google Cloud Platform (GCP)<a class="headerlink" href="#paratools-pro-for-e4stm-getting-started-with-google-cloud-platform-gcp" title="Permanent link">&para;</a></h1>
<h2 id="general-background-information">General Background Information<a class="headerlink" href="#general-background-information" title="Permanent link">&para;</a></h2>
<p>In the following tutorial, we roughly follow the same steps as the
<a href="https://cloud.google.com/hpc-toolkit/docs/quickstarts/slurm-cluster">"quickstart tutorial"</a> from the <a href="https://github.com/GoogleCloudPlatform/hpc-toolkit?tab=readme-ov-file#quickstart">Google HPC-Toolkit</a> project.
For the purposes of this tutorial, we make the following assumptions:</p>
<ul>
<li>You have <a href="https://console.cloud.google.com/freetrial">created a Google Cloud account</a>.</li>
<li>You have <a href="https://cloud.google.com/resource-manager/docs/creating-managing-projects">created a Google Cloud project</a> appropriate for this tutorial
  and it is <a href="https://console.cloud.google.com/projectselector2/home/dashboard">selected</a>.</li>
<li>You have <a href="https://cloud.google.com/billing/docs/how-to/verify-billing-enabled#console">setup billing for your Google Cloud Project</a>.</li>
<li>You have <a href="https://console.cloud.google.com/apis/api/compute.googleapis.com/overview">enabled the Compute Engine API</a>.</li>
<li>You have <a href="https://console.cloud.google.com/apis/api/file.googleapis.com/overview">enabled the Filestore API</a>.</li>
<li>You have <a href="https://console.cloud.google.com/apis/api/storage.googleapis.com/overview">enabled the Cloud Storage API</a></li>
<li>You have <a href="https://console.cloud.google.com/apis/api/serviceusage.googleapis.com/overview">enabled the Sevice Usage API</a>.</li>
<li>You have <a href="https://console.cloud.google.com/apis/api/secretmanager.googleapis.com/overview">enabled the Secret Manager API</a>.</li>
<li>You are aware of <a href="https://cloud.google.com/hpc-toolkit/docs/quickstarts/slurm-cluster#costs">the costs for running instances on GCP Compute Engine</a> and
  of the costs of using the ParaTools Pro for E4S™ GCP marketplace VM image. <!-- FIXME: these need links when marketplace goes live --></li>
<li>You are comfortable using the <a href="https://cloud.google.com/hpc-toolkit/docs/quickstarts/slurm-cluster#launch">GCP Cloud Shell</a>, or are running locally
    (which will match this tutorial) and are familiar with SSH, a terminal and have
    <a href="https://cloud.google.com/sdk/docs/install">installed</a> and <a href="https://cloud.google.com/sdk/docs/initializing">initialized the gcloud CLI</a></li>
</ul>
<h2 id="tutorial">Tutorial<a class="headerlink" href="#tutorial" title="Permanent link">&para;</a></h2>
<h3 id="getting-set-up">Getting Set Up<a class="headerlink" href="#getting-set-up" title="Permanent link">&para;</a></h3>
<p>First, let's grab your <code>PROJECT_ID</code> and <code>PROJECT_NUMBER</code>.
Navigate to the <a href="https://console.cloud.google.com/projectselector2/home/dashboard">GCP project selector</a> and select the project that you'll be using for this tutorial.
Take note of the <code>PROJECT_ID</code> and <code>PROJECT_NUMBER</code>
Open your local shell or the <a href="https://cloud.google.com/hpc-toolkit/docs/quickstarts/slurm-cluster#launch">GCP Cloud Shell</a>, and run the following commands:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PROJECT_ID</span><span class="o">=</span>&lt;enter<span class="w"> </span>your<span class="w"> </span>project<span class="w"> </span>ID<span class="w"> </span>here&gt;
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PROJECT_NUMBER</span><span class="o">=</span>&lt;enter<span class="w"> </span>your<span class="w"> </span>project<span class="w"> </span>number<span class="w"> </span>here&gt;
</code></pre></div></td></tr></table></div></p>
<p>Set a default project you will be using for this tutorial.
If you have multiple projects you can switch back to a different one when you are finished.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>gcloud<span class="w"> </span>config<span class="w"> </span><span class="nb">set</span><span class="w"> </span>project<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">PROJECT_ID</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
<p>Next, ensure that the default Compute Engine service account is enabled:
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>gcloud<span class="w"> </span>iam<span class="w"> </span>service-accounts<span class="w"> </span><span class="nb">enable</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="w">     </span>--project<span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">PROJECT_ID</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="w">     </span><span class="si">${</span><span class="nv">PROJECT_NUMBER</span><span class="si">}</span>-compute@developer.gserviceaccount.com
</code></pre></div>
and add the <code>roles/editor</code> IAM role to the service account:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>gcloud<span class="w"> </span>projects<span class="w"> </span>add-iam-policy-binding<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">PROJECT_ID</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">    </span>--member<span class="o">=</span>serviceAccount:<span class="si">${</span><span class="nv">PROJECT_NUMBER</span><span class="si">}</span>-compute@developer.gserviceaccount.com<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">    </span>--role<span class="o">=</span>roles/editor
</code></pre></div>
<h3 id="install-the-google-cloud-hpc-toolkit">Install the <a href="https://github.com/GoogleCloudPlatform/hpc-toolkit?tab=readme-ov-file#quickstart">Google Cloud HPC-Toolkit</a><a class="headerlink" href="#install-the-google-cloud-hpc-toolkit" title="Permanent link">&para;</a></h3>
<p>First install the dependencies of <code>ghpc</code>. Instructions to do this are included below.
If you encounter trouble please check the latest instructions from Google,
available <a href="https://cloud.google.com/hpc-toolkit/docs/setup/install-dependencies">here</a>. If you are running the google cloud shell you do not need to install the dependencies and can skip to cloning the hpctoolkit.</p>
<div class="admonition info">
<p class="admonition-title">Install the <a href="https://github.com/GoogleCloudPlatform/hpc-toolkit?tab=readme-ov-file#quickstart">Google Cloud HPC-Toolkit</a>  Prerequisites</p>
<p>Please download and install any missing software packages from the following list:</p>
<ul>
<li><a href="https://www.terraform.io/downloads">Terraform</a> version 1.2.0 or later</li>
<li><a href="https://www.packer.io/downloads">Packer</a> version 1.7.9 or later</li>
<li><a href="https://go.dev/doc/install">Go</a> version 1.188 or later. Ensure that the <code>GOPATH</code> is setup and <code>go</code> is on your <code>PATH</code>.
  You may need to add the following to <code>.profile</code> or <code>.bashrc</code> startup "dot" file:
  <div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:<span class="k">$(</span>go<span class="w"> </span>env<span class="w"> </span>GOPATH<span class="k">)</span>/bin
</code></pre></div></li>
<li><a href="https://github.com/git-guides/install-git">Git</a></li>
<li><code>make</code> (see below for instructions specific to your OS)</li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="1:3"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><input id="__tabbed_1_3" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">macOS</label><label for="__tabbed_1_2">Ubuntu/Debian</label><label for="__tabbed_1_3">CentOS/RHEL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><code>make</code> is packaged with the Xcode command line developer tools on macOS.
To install, run:
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>xcode-select<span class="w"> </span>--install
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p>Install <code>make</code> with the OS' package manager:
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>apt-get<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>make
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p>Install <code>make</code> with the OS' package manager:
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>yum<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>make
</code></pre></div></p>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Most of the packages above may be installable through your OSes package manager.
For example, if you have <a href="https://brew.sh">Homebrew</a> on macOS you should be able to <code>brew install &lt;package_name&gt;</code>
for most of these items, where <code>&lt;package_name&gt;</code> is, e.g., <code>go</code>.</p>
</div>
</div>
<p>Once all the software listed above has been verified and/or installed, clone the <a href="https://github.com/GoogleCloudPlatform/hpc-toolkit?tab=readme-ov-file#quickstart">Google Cloud HPC-Toolkit</a>
and change directories to the cloned repository:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">1</a></span>
<span class="normal"><a href="#__codelineno-8-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/GoogleCloudPlatform/hpc-toolkit.git
<a id="__codelineno-8-2" name="__codelineno-8-2"></a><span class="nb">cd</span><span class="w"> </span>hpc-toolkit/
</code></pre></div></td></tr></table></div>
Next build the HPC-Toolkit and verify the version and that it built correctly.
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>make
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>./ghpc<span class="w"> </span>--version
</code></pre></div>
If you would like to install the compiled binary to a location on your <code>$PATH</code>,
run
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>sudo<span class="w"> </span>make<span class="w"> </span>install
</code></pre></div>
to install the <code>ghpc</code> binary into <code>/usr/local/bin</code>, of if you do not have root
priviledges or do not want to install the binary into a system wide location, run
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>make<span class="w"> </span>install-user
</code></pre></div>
to install <code>ghpc</code> into <code>${HOME}/bin</code> and then ensure this is on your path:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">PATH</span><span class="si">}</span><span class="s2">:</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/bin&quot;</span>
</code></pre></div>
<h3 id="grant-adc-access-to-terraform-and-enable-os-login">Grant ADC access to Terraform and Enable OS Login<a class="headerlink" href="#grant-adc-access-to-terraform-and-enable-os-login" title="Permanent link">&para;</a></h3>
<p>Generate cloud credentials associated with your Google Cloud account and grant
Terraform access to the Aplication Default Credential (ADC).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are using the <a href="https://cloud.google.com/hpc-toolkit/docs/quickstarts/slurm-cluster#launch">Cloud Shell</a> you can skip this step.</p>
</div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>gcloud<span class="w"> </span>auth<span class="w"> </span>application-default<span class="w"> </span>login
</code></pre></div>
<p>To be able to connect to VMs in the cluster OS Login must be enabled.
Unless OS Login is already enabled at the organization level, enable it at the project level.
To do this, run:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>gcloud<span class="w"> </span>compute<span class="w"> </span>project-info<span class="w"> </span>add-metadata<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="w">     </span>--metadata<span class="w"> </span>enable-oslogin<span class="o">=</span>TRUE
</code></pre></div>
<h3 id="deploy-the-cluster">Deploy the Cluster<a class="headerlink" href="#deploy-the-cluster" title="Permanent link">&para;</a></h3>
<p>Copy the <a href="../blueprint/#e4s-pro-slurm-cluster-blueprint-example">ParaTools-Pro-slurm-cluster-blueprint-example</a> from the
ParaTools Pro for E4S™ documentation to your clipboard, then paste it into a file named
<code>ParaTools-Pro-Slurm-Cluster-Blueprint.yaml</code>. After copying the text, in your terminal
do the following:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>cat<span class="w"> </span>&gt;<span class="w"> </span>ParaTools-Pro-Slurm-Cluster-Blueprint.yaml
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="c1"># paste the copied text # (1)</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="c1"># press Ctrl-d to add an end-of-file character</span>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>cat<span class="w"> </span>ParaTools-Pro-Slurm-Cluster-Blueprint.yaml<span class="w"> </span><span class="c1"># Check the file copied correctly #(2)</span>
</code></pre></div>
<ol>
<li>
<div class="admonition note">
<p class="admonition-title">Note</p>
   Usually <code>Ctrl-v</code>, or <code>Command-v</code> on macOS</div>
</li>
<li>
<div class="admonition note">
<p class="admonition-title">Note</p>
   This is optional, but usually a good idea</div>
</li>
</ol>
<p>Using your favorite editor, select appropriate instance types for the compute partitions,
and remove the h3 partition if you do not have access to h3 instances yet.
See the expandable annotations and pay extra attention to the highlighted lines
on the <a href="../blueprint/#e4s-pro-slurm-cluster-blueprint-example">ParaTools-Pro-slurm-cluster-blueprint-example</a> example.</p>
<div class="admonition tip">
<p class="admonition-title">Pay Attention</p>
<p>In particular:</p>
<ul>
<li>Determine if you want to pass the <code>${PROJECT_ID}</code> on the command line or in the blueprint</li>
<li>Verify that the <code>image_family</code> key matches the image for ParaTools Pro for E4S™ from the GCP marketplace</li>
<li>Adjust the region and zone used, if desired</li>
<li>Limit the IP <code>ranges</code> to those you will be connecting from via SSH in the <code>ssh-login</code>
  <code>firewall_rules</code> rule, if in a production setting.
  If you plan to connect only from the <a href="https://cloud.google.com/hpc-toolkit/docs/quickstarts/slurm-cluster#launch">cloud shell</a> the <code>ssh-login</code>
  <code>firewall_rules</code> rule may be completely removed.</li>
<li>Set an appropriate <code>machine_type</code> and <code>dynamic_node_count_max</code> for your <code>compute_node_group</code>.</li>
</ul>
</div>
<p>Once the blue print is configured to be consistent with your GCP usage quotas and your preferences,
set deployment variables and create the deployment folder.</p>
<div class="admonition info">
<p class="admonition-title">Create deployment folder</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>./ghpc<span class="w"> </span>create<span class="w"> </span>e4s-23.11-cluster-slurm-gcp-5-9-hpc-rocky-linux-8.yaml<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="w">  </span>--vars<span class="w"> </span><span class="nv">project_id</span><span class="o">=</span><span class="si">${</span><span class="nv">PROJECT_ID</span><span class="si">}</span><span class="w"> </span><span class="c1"># (1)!</span>
</code></pre></div>
<ol>
<li>
<div class="admonition note">
<p class="admonition-title">Note</p>
   If you uncommented and updated the <code>vars.project_id:</code> you do not need to pass
   <code>--vars project_id=...</code> on the command line.
   If you're bringing a cluster back online that was previously deleted, but
   the blueprint has been modified and the deployment folder is still present,
   the <code>-w</code> flag will let you overwrite the deployment folder contents with the
   latest changes.</div>
</li>
</ol>
</div>
<details class="note inline end">
<summary>Note</summary>
<p>It may take a few minutes to finish provisioning your cluster.</p>
</details>
<p>Now the cluster can be deployed.
Run the following command to deploy your ParaTools Pro for E4S™ cluster:</p>
<div class="admonition info">
<p class="admonition-title">Perform the deployment</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>./ghpc<span class="w"> </span>deploy<span class="w"> </span>ppro-4-e4s-23-11-cluster-slurm-rocky8
</code></pre></div>
</div>
<p>At this point you will be prompted to review or accept the proposed changes.
You may review them if you like, but you should press <code>a</code> for accept once satisfied.</p>
<h3 id="connect-to-the-cluster">Connect to the Cluster<a class="headerlink" href="#connect-to-the-cluster" title="Permanent link">&para;</a></h3>
<p>Once the cluster is deployed, ssh to the login node.</p>
<ol>
<li>
<p>Go to the <strong>Compute Engine &gt; VM Instances</strong> page.</p>
<p><a class="md-button" href="https://console.cloud.google.com/compute/instances">GCP VM Instances</a></p>
</li>
<li>
<p>Click on <code>ssh</code> for the login node of the cluster. You may need to approve Google authentication before the session can connect.</p>
</li>
</ol>
<h3 id="deletion-of-the-cluster">Deletion of the Cluster<a class="headerlink" href="#deletion-of-the-cluster" title="Permanent link">&para;</a></h3>
<p>It is very important that when you are done using the cluster you must use ghcp to destroy it. If your instances were deleted in a different manner, see here. To delete your cluster correctly do</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>./ghpc destroy ppro-4-e4s-23-11-cluster-slurm-rocky8
</code></pre></div>
At this point you will be prompted to review or accept the proposed changes.
You may review them if you like, but you should press <code>a</code> for accept once satisfied and the deletion will proceed.</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2023 <a href="https://www.paratools.com/" target="blank" rel="noopener">ParaTools, Inc.</a>

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/ParaToolsInc/ParaToolsPro" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            




  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.sections", "toc.follow", "toc.integrate", "navigation.top", "search.suggest", "search.highlight", "contgent.tabs.link", "content.code.annotation", "content.code.annotate", "content.code.copy", "content.code.select", "content.tabs.link"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
    
  </body>
</html>